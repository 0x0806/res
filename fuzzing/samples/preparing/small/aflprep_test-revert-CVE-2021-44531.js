'use strict';
if (!common.hasCrypto)
  common.skip('missing crypto');
const assert = require('assert');
const util = require('util');
const tls = require('tls');
const tests = [
  {
    host: '8.8.8.8',
    error: 'IP: 8.8.8.8 is not in the cert\'s list: '
  },
  {
    host: 'a.b.a.com', cert: {
    }
  },
  {
    host: 'a.b.a.com', cert: {
      subject: {}
    }
  },
  {
    host: 'a.b.a.com', cert: {
      subject: {}
    },
    error: 'Host: a.b.a.com. is not in the cert\'s altnames: ' +
  },
];
tests.forEach(function(test, i) {
  const err = tls.checkServerIdentity(test.host, test.cert);
  assert.strictEqual(err && err.reason,
                     test.error,
                     `Test# ${i} failed: ${util.inspect(test)} \n` +
                     `${test.error} != ${(err && err.reason)}`);
});
